---
title: "Iris K-Means Clustering"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    social: menu
    source_code: embed
runtime: shiny
---

```{r global, include=FALSE}
options(shiny.sanitize.errors = FALSE)
library(ggplot2)
library(plotly)
library(plyr)
library(xkcdcolors)
library(flexdashboard)

if (dir.exists('data/')) {
  filesDir <- 'data/'
} else {
  filesDir <- '/home/reid/int-reidmcy/data/'
}


target_names <- c('econ', 'so', 'psy', 'com')
names(target_names) <- c('econ', 'so', 'psy', 'com')

files <- c('tsne_Economics.csv', 'tsne_Stack Overflow.csv', 'tsne_Psychology & Neuroscience.csv', 'tsne_combined.csv')
colours <- c(name2color("light orange"), name2color("light blue"), name2color("light green"), name2color("black"))

df_attributes <- data.frame(file=files, colour=colours, row.names=target_names)
#row.names(df_attributes) <- names

```

Column {.sidebar}
-----------------------------------------------------------------------

```{r}
selectInput(inputId = 'var',
            label = 'X Variable',
            choices = target_names)
```

Column
-----------------------------------------------------------------------

### K Means
```{r}
df_target <- reactive({
  read.csv(paste(filesDir, df_attributes[input$var,'file'], sep = ''))
})


renderPlotly({ 
  tsne_plot <- ggplot(data = df_target(), aes(x=tsne_0, y=tsne_1, label=tag)) +
    geom_text(size = 4) +
    theme(plot.title = element_text(size =12),
        axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(),
        axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank(),
        panel.background=element_blank())
  ggplotly(tsne_plot)
})
```
